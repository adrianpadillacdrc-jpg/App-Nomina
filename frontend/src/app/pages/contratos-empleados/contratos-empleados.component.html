<!-- src/app/pages/contratos-empleados/contratos-empleados.component.html -->
<div class="page-wrapper">
    <app-sidebar></app-sidebar>
    <main class="main-content">
        <div class="container">
            <h1 class="page-title">Contratos de Empleados</h1>

            <div class="search-box">
                <input type="text" class="search-input" placeholder="Buscar por nombre, c√©dula o cargo..."
                    [(ngModel)]="busqueda" (input)="filtrar()">
            </div>

            <div class="tabla-empleados">
                <div class="header-row">
                    <div>Documento</div>
                    <div>Nombre Completo</div>
                    <div>Cargo</div>
                    <div>Acci√≥n</div>
                </div>

                <div *ngIf="empleadosFiltrados.length === 0" class="empty-state">
                    No se encontraron empleados
                </div>

                <div class="empleado-row" *ngFor="let emp of empleadosFiltrados">
                    <div>{{ emp.documento }}</div>
                    <div class="nombre">{{ emp.nombre }} {{ emp.apellido }}</div>
                    <div>{{ emp.cargo }}</div>
                    <div>
                        <button class="btn-contrato" (click)="verContrato(emp)">
                            Ver Contrato
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </main>
</div>

<!-- MODAL CONTRATO - 100% NUMA S.A.S -->
<div class="overlay" *ngIf="mostrarContrato" (click)="cerrarContrato()">
    <div class="modal-contrato" (click)="$event.stopPropagation()">
        <button class="cerrar" (click)="cerrarContrato()">√ó</button>

        <div class="contrato-content">
            <!-- Informaci√≥n del estado del contrato -->
            <div class="estado-contrato" *ngIf="contratoSeleccionado">
                <div class="badge" [class.vigente]="contratoSeleccionado.estado === 'VIGENTE'"
                    [class.terminado]="contratoSeleccionado.estado === 'TERMINADO'">
                    {{ contratoSeleccionado.estado }}
                </div>
                <p><strong>Fecha de inicio:</strong> {{ contratoSeleccionado.fechaInicio | date:'fullDate' }}</p>
                <p><strong>Fecha de fin:</strong> {{ contratoSeleccionado.fechaFin | date:'fullDate' }}</p>
            </div>

            <div class="header-contrato">
                <img src="/assets/logo.png" alt="NUMA S.A.S" class="logo-empresa">
                <div class="info-empresa">
                    <h1>NUMA S.A.S</h1>
                    <h2>Soluciones Integrales de N√≥mina</h2>
                    <p><strong>NIT:</strong> 901.234.567-8</p>
                    <p>Cartagena, Colombia</p>
                </div>
            </div>

            <h1 class="titulo-contrato">CONTRATO INDIVIDUAL DE TRABAJO A T√âRMINO FIJO</h1>

            <table class="tabla-datos">
                <tr>
                    <td><strong>NOMBRE DEL EMPLEADOR:</strong></td>
                    <td>NUMA S.A.S</td>
                </tr>
                <tr>
                    <td><strong>REPRESENTANTE LEGAL:</strong></td>
                    <td>ING. ADRIAN ANDRES PADILLA ROQUEME</td>
                </tr>
                <tr>
                    <td><strong>NOMBRE DEL EMPLEADO(A):</strong></td>
                    <td>{{ empleadoSeleccionado?.nombre?.toUpperCase() }} {{
                        empleadoSeleccionado?.apellido?.toUpperCase() }}</td>
                </tr>
                <tr>
                    <td><strong>IDENTIFICADO(A) CON:</strong></td>
                    <td>C.C. {{ empleadoSeleccionado?.documento }}</td>
                </tr>
                <tr>
                    <td><strong>LUGAR DE RESIDENCIA:</strong></td>
                    <td>CARTAGENA.</td>
                </tr>
                <tr>
                    <td><strong>TEL√âFONO:</strong></td>
                    <td>{{ empleadoSeleccionado?.telefono || 'No registrado' }}</td>
                </tr>
                <tr>
                    <td><strong>CARGO:</strong></td>
                    <td>{{ empleadoSeleccionado?.cargo?.toUpperCase() }}</td>
                </tr>
                <tr>
                    <td><strong>SALARIO MENSUAL:</strong></td>
                    <td>$ {{ (empleadoSeleccionado?.salarioBase || 0) | number:'1.0-0' }}</td>
                </tr>
                <tr>
                    <td><strong>FECHA DE INICIO:</strong></td>
                    <td>{{ (contratoSeleccionado?.fechaInicio || nuevoContrato.fechaInicio) | date:'fullDate' }}</td>
                </tr>
                <tr>
                    <td><strong>FECHA DE FIN:</strong></td>
                    <td>{{ (contratoSeleccionado?.fechaFin || nuevoContrato.fechaFin) | date:'fullDate' }}</td>
                </tr>
                <tr>
                    <td><strong>ESTADO:</strong></td>
                    <td>{{ contratoSeleccionado?.estado || 'NUEVO' }}</td>
                </tr>
            </table>

            <div class="clausulas">
                <p>Conste por el presente documento que entre <strong>NUMA S.A.S</strong>, representada legalmente por
                    el <strong>ING. ADRIAN PADILLA ROQUEME</strong>, y el(la) trabajador(a) arriba identificado(a), se
                    celebra un <strong>CONTRATO INDIVIDUAL DE TRABAJO A T√âRMINO FIJO</strong> conforme a las siguientes
                    cl√°usulas:</p>

                <p><strong>PRIMERA - OBJETO:</strong> El trabajador se obliga a prestar sus servicios personales bajo
                    dependencia y subordinaci√≥n al empleador, desempe√±ando el cargo de <strong>{{
                        empleadoSeleccionado?.cargo?.toUpperCase() }}</strong>.</p>

                <p><strong>SEGUNDA - DURACI√ìN:</strong> El presente contrato tendr√° una duraci√≥n de <strong>UN (1)
                        A√ëO</strong> contado a partir de la fecha de ingreso, pudiendo ser renovado por mutuo acuerdo.
                </p>

                <p><strong>TERCERA - JORNADA:</strong> La jornada laboral ser√° de 48 horas semanales, distribuidas seg√∫n
                    las necesidades de la empresa, cumpliendo con la normatividad laboral vigente.</p>

                <p><strong>CUARTA - REMUNERACI√ìN:</strong> El trabajador devengar√° un salario mensual de <strong>$ {{
                        (empleadoSeleccionado?.salarioBase || 0) | number:'1.0-0' }}</strong> pesos colombianos,
                    pagadero quincenalmente.</p>

                <p><strong>QUINTA - LUGAR DE TRABAJO:</strong> Las labores se desarrollar√°n en las instalaciones de NUMA
                    S.A.S ubicadas en la ciudad de Cartagena o en el lugar que la empresa determine.</p>
            </div>

            <div class="footer-contrato">
                <p><strong>Fecha de generaci√≥n:</strong> {{ hoy | date:'fullDate' | titlecase }}</p>
                <div class="firmas">
                    <div class="firma-empleado">
                        <div class="linea-firma"></div>
                        <p>Firma del Empleado(a)</p>
                        <p>{{ empleadoSeleccionado?.nombre }} {{ empleadoSeleccionado?.apellido }}</p>
                    </div>
                    <div class="firma-empleador">
                        <div class="linea-firma"></div>
                        <p>ING. ADRIAN ANDRES PADILLA ROQUEME</p>
                        <p>Representante Legal - NUMA S.A.S</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- BOTONES DE ACCI√ìN -->
        <div class="botones-accion">
            <!-- Bot√≥n para crear contrato si no existe -->
            <button *ngIf="!contratoSeleccionado" class="btn-crear" (click)="crearNuevoContrato()">
                üìù CREAR CONTRATO
            </button>

            <!-- Botones para contratos existentes -->
            <div *ngIf="contratoSeleccionado" class="botones-contrato-existente">
                <button class="btn-imprimir" (click)="imprimirContrato()" [disabled]="generandoPDF">
                    üñ®Ô∏è IMPRIMIR
                </button>
                <button class="btn-descargar" (click)="descargarContrato()" [disabled]="generandoPDF">
                    üì• DESCARGAR PDF
                </button>

                <!-- Botones de estado -->
                <button *ngIf="contratoSeleccionado.estado === 'VIGENTE'" class="btn-terminar"
                    (click)="cambiarEstadoContrato('TERMINADO')">
                    üî¥ TERMINAR CONTRATO
                </button>
                <button *ngIf="contratoSeleccionado.estado === 'TERMINADO'" class="btn-reactivar"
                    (click)="cambiarEstadoContrato('VIGENTE')">
                    üîµ REACTIVAR CONTRATO
                </button>
            </div>
        </div>
    </div>
</div>